@model CJCProjectEstimatorMVC.Models.AppUser
@{
    ViewBag.Title = "Sign-up";
}




@*    $userName = $_POST["userName"];
    $firstName = $_POST["firstName"];
    $lastName = $_POST["lastName"];
    $companyName = $_POST["companyName"];
    $password = $_POST["password"];
    $passwordConfirm = $_POST["passwordConfirm"];
    
    $errorMessages = '';
    
    if(! empty($_POST)) {
        if(empty($userName)) {
            $errorMessages .= "<li>User Name is a required field.</li>";
        }
        if(empty($firstName)) {
            $errorMessages .= "<li>First Name is a required field.</li>";
        }
        if(empty($lastName)) {
            $errorMessages .= "<li>Last Name is a required field.</li>";
        }        
        if(empty($password)) {
            $errorMessages .= "<li>Password is a required field.</li>";
        }        
        if(empty($passwordConfirm)) {
            $errorMessages .= "<li>Confirm Password is a required field.</li>";
        }
        if($password != $passwordConfirm) {
            $errorMessages .= "<li>Password fields do not match.</li>";
        }
        
        // if we didn't get any errors then let's go ahead and insert
        if(empty($errorMessages)) {
            // make sure that the user name is not already being used
            $conn = dbConnect();

            $stmt = $conn->prepare('select UserName from appusers where UserName = :userName');
            $stmt->bindParam(':userName', $userName, PDO::PARAM_STR);
            $stmt->execute();
            $results = $stmt->fetchAll(PDO::FETCH_ASSOC);  //retreive the rows as an associative array


            dbDisconnect($conn);

            if(count($results) > 0) {
                $errorMessages .= "<li>That User Name is already being used. Please choose another.</li>";
            } else {
                
                $passwordSalt = date('YmdHis');
                $passwordHash = hash('sha256', $password . $passwordSalt);
                
                $query = $conn->prepare('insert into appusers (username, firstname, lastname, companyname, passwordhash, passwordsalt ) values (:userName, :firstName, :lastName, :companyName, :passwordHash, :passwordSalt)');
                $query->bindParam(':userName', trim($userName));
                $query->bindParam(':firstName', trim($firstName));
                $query->bindParam(':lastName', trim($lastName));
                $query->bindParam(':companyName', trim($companyName));
                $query->bindParam(':passwordHash', trim($passwordHash));
                $query->bindParam(':passwordSalt', trim($passwordSalt));
                
                $query->execute();
                
                setcookie('auth', $passwordHash, time()+3600);
                redirect('thankyou.php');
                
                
                
            }
            


        }
        
        
        
        
    }
    
?>
*@  
   <h3><br />Sign up for the CJC Project Estimator</h3>
   <p>It's <strong>free</strong> and we won't spam you.</p>
   
   <div class="fieldset">
    <h4 class="legend">Sign-up</h4>
    @using (Html.BeginForm("Signup", "Signup"))
    {

        
@*    <?php
    if(! empty($errorMessages)) {
        echo('<ul class="errorMessage">');
        echo($errorMessages); 
        echo('</ul><br/>');
    }
    ?>*@

       
        
    <table class="table">
      <tr >
        <td class="firstcoll">User Name:<span class='required'>*</span></td>
        <td>@Html.TextBoxFor(model => model.UserName, new { maxlength = 45, size = 25 })</td>
      </tr>
      <tr >
        <td class="firstcoll">First Name:<span class='required'>*</span></td>
        <td>@Html.TextBoxFor(model => model.FirstName, new { maxlength = 45, size = 25 })</td>
      </tr>
      <tr>
        <td class="firstcoll">Last Name:<span class='required'>*</span></td>
        <td>@Html.TextBoxFor(model => model.LastName, new { maxlength = 45, size = 25 })</td>
      </tr>
      <tr>
        <td class="firstcoll">Company Name: </td>
        <td>@Html.TextBoxFor(model => model.CompanyName, new { maxlength = 45, size = 25 })</td>
      </tr>
      <tr>
        <td class="firstcoll">Password:<span class='required'>*</span></td>
        <td><input name="password" type="password"  size="25" maxlength="15" /></td>
      </tr>
      <tr>
        <td class="firstcoll">Confirm Password:<span class='required'>*</span></td>
        <td><input name="passwordConfirm" type="password"  size="25" maxlength="15" /></td>
      </tr>
      <tr>
        <td class="firstcoll" />
        <td class="submitcoll"><input class="input" type="submit" name="Submit" id="submit" value="Submit" /></td>
      </tr>
    </table>

     
    <span class='required'>* Required Fields</span>
    <p>&nbsp;</p>

    }
    </div>